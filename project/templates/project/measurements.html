{% extends 'project/base.html' %}
{% load static %}
{% block navcontent %}
{% endblock %}
{% block maincontent %}
<h3 class="text-light fw-bolder" style="text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);">BILL : MEASUREMENTS</h3>
    {% if msg %}
    <div class="p-3 my-2 bg-light">
        <h2 class="form-heading text-danger fw-bolder m-3">{{msg}}</h2>
    </div>    
    {% endif %}
    

{% if item %} 
<div class="card mt-2" > 
    <div class="row">
        <h4 class="m-3"><a href="{% url 'project:CurrentBill' 1 %}" >Add Measurement of another item</a></h4>
    </div>
    <div class="row ms-3 pt-3">
        
        <h5>ITEM : {{item.description}}</h5>
    </div>                 
    <div class="row ms-3">
        <div class="col-md-3  p-4">
            <h4 class="fw-bold">Work Order BoQ details of item </h4>
            <hr>            
            <div>
                <label for="rate" class="fw-bolder w-25">Rate : </label>
                <span style="font-size:20px;" id="rate">{{ item.rate }}</span>            
            </div>
            <div >
                <label for="units" class="fw-bolder w-25">Units : </label>
                <span style="font-size:20px;" id="units">{{ item.unit }}</span>            
            </div>
            <div>
                <label for="quantity" class="fw-bolder w-25">Quantity : </label>
                <span style="font-size:20px;" id="quantity">{{ item.quantity }}</span> 
            </div>
            <div>
                <label for="amount" class="fw-bolder w-25" >Amount : </label>
                <span style="font-size:20px;" id="amount">{{ item.amount }}</span> 
            </div>            
        
            <h4 class="mt-3 fw-bold">Current Quantity details for item</h4>
            <hr>
            <div>
                <label for="current_quantity" class="fw-bolder mt-3 w-50">Consumed Quantity :</label>
                <span style="font-size:20px;" id="current_quantity">{{ current_quantity }}</span> 
            </div>
            <div id="qntydiv">
                <label for="available_quantity" class="fw-bolder w-50">Available Quantity :</label>
                <span style="font-size:20px;" id="available_quantity"></span>
            </div>   
            <div>
                <label for="dummy" class="fw-bolder w-25"></label>
                <span style="font-size:20px;" id="dummy"></span>
            </div>  
        </div>             
        <div class="col-md-7">
            <form class="p-4" action="{% url 'project:Measurements' item.id 1 %}" id="measurements_form" method="POST" >
                {% csrf_token %}  
                <h4 class="fw-bold">Add new measurement </h4>
                <hr>  
                <div class="row  my-0 "> 
                    <div class="col-md-9">
                        <label for="mdesc" class="text-dark">Enter Measurement Descritpion</label>
                        <input type="text" id="mdesc" name="mdesc" class="form-control mb-3 w-100"> 
                    </div>               
                    <div class="col-md-3">
                        <label for="entry_date" class="text-dark">Select entry date mm/dd/yyyy</label>
                        {% if last_measure_date %} 
                            <input type="date" id="entry_date" name="entry_date" class="form-control mb-3 w-100" value="{{last_measure_date|date:'Y-m-d'}}"  required>                
                        
                        {% else %}
                            <input type="date" id="entry_date" name="entry_date" class="form-control mb-3 w-100"  required>                
                        {% endif  %}
                    </div>                      
                </div>                               
                <div class="row">
                    <small style="font-size: 15px;font-weight: bold;color: orangered;"><b>CAUTION :</b>Unit of the entries must be same as work order BoQ unit of this item.</small>
                    <div class="col-md-2">
                        <label for="newcount" class=" text-dark">Enter Item Count</label>
                        <input value="1" type="number" id="newcount" name="newcount" class="form-control mb-3" required>                
                    </div>
                    <div class="col-md-2">
                        <label for="newlength" class=" text-dark">Enter Item Length</label>
                        <input value="1" type="number" step="0.001" id="newlength" name="newlength" class="form-control mb-3" required>                
                    </div>
                    <div class="col-md-2">
                        <label for="newbreadth" class=" text-dark">Enter Item Breadth</label>
                        <input value="1" type="number" step="0.001" id="newbreadth" name="newbreadth" class="form-control mb-3" required>                
                    </div>
                    <div class="col-md-2">
                        <label for="newheight" class=" text-dark" >Enter Item Height</label>
                        <input value="1" type="number" step="0.001" id="newheight" name="newheight" class="form-control mb-3" required>                
                    </div>
                
                    <div class="col-md-2">
                        <label for="newnumber" class=" text-dark" >Enter numbers</label>
                        <input value="1" type="number" step="0.001" id="newnumber" name="newnumber" class="form-control mb-3" required>                
                    </div>
        
                    <div class="col-md-2">
                        <label for="newquantity" class=" text-dark" >Quantity</label>
                        <input value="1" type="number" step="0.001" id="newquantity" name="newquantity" class="form-control mb-3" required>                
                    </div>
                </div>
                <div class="row  my-0 bg-light">
                    <label id="qtywarning" class="text-danger fw-bolder"></label>
                </div>  
                <div class="row  my-0 pb-3">
                    <center>
                        <input type="submit" id="savemeasurement" class="btn form-btn-custom w-25" value="Save Measurement">
                    </center>                    
                </div>                    
            </form>
        </div>    
    </div>
</div>    
{% if page_object %}
<div class="card-trans border-primary bg-light mt-5 m-3 p-3" > 

    <div class="inline-items ">
        <span class="mx-2 bg-secondary text-light p-3 fw-bold">Total Pages : {{page_object.paginator.num_pages}} (Showing 100 measurements per page)</span>
        {% if page_object.has_previous %}
            <a href="{% url 'project:Measurements' item.id page_object.number|add:'-1' %}" class="btn btn-custom m-1 rounded-circle"><i class="fas fa-reply text-primary py-2"></i></a> 
        {% endif %}
        <span class="mx-2 bg-secondary text-light p-3"><b>Current Page : {{page_object.number}}</b></span>
        {% if page_object.has_next %}
            <a href="{% url 'project:Measurements' item.id page_object.number|add:'1' %}" class="btn btn-custom m-1 rounded-circle"><i class="fas fa-share text-primary py-2"></i></a> 
        {% endif %}
        
    </div>
    
    <table class="table table-bordered bg-light border-primary m-2 p-3 shadow-lg" style="max-width: 95%;font-weight: bold;">
        <thead class="bg-secondary text-light">
            <tr>
                <th scope="col">DATE</th> 
                <th scope="col">DESCRIPTION</th>
                <th scope="col">COUNT</th>
                <th scope="col">LENGTH</th>
                <th scope="col">BREADTH</th>
                <th scope="col">HEIGHT</th>
                <th scope="col">NUMBERS</th>
                <th scope="col">QUANTITY</th>                
                <th scope="col">DELETE</th>
                <th scope="col">EDIT</th>
            </tr>
        </thead>
        <tbody >            
            {% for object in page_object %}            
            <tr >
                <th scope="row">{{object.entry_date}}</th>
                <td>{{object.m_description}}</td>
                <td>{{object.count}}</td>
                <td >{{object.length}}</td>
                <td>{{object.breadth}}</td>
                <td>{{object.height}}</td>
                <td>{{object.number}}</td>
                <td>{{object.quantity}}</td>     
                
                <!-- <td>
                    <a href="" class="btn btn-custom m-1 rounded-circle">
                    <i class="fas fa-pencil py-2" style="color: blue;font-size:20px;"></i></a>
                </td> -->
                
                <td>
                    <a class="text-danger" href="{% url 'project:DeleteMeasurement' object.id %}" >
                    Remove</a>
                </td>
                <td>
                    <a href="{% url 'project:EditMeasurement' object.id %}" >
                    Edit</a>
                </td>
            </tr>
            {% endfor %}            
        </tbody>
    </table>  
    <div class="inline-items ">
        <span class="mx-2 bg-secondary text-light p-3 fw-bold">Total Pages : {{page_object.paginator.num_pages}} (Showing 100 measurements per page)</span>
        {% if page_object.has_previous %}
            <a href="{% url 'project:Measurements' item.id page_object.number|add:'-1' %}" class="btn btn-custom m-1 rounded-circle"><i class="fas fa-reply text-primary py-2"></i></a> 
        {% endif %}
        <span class="mx-2 bg-secondary text-light p-3"><b>Current Page : {{page_object.number}}</b></span>
        {% if page_object.has_next %}
            <a href="{% url 'project:Measurements' item.id page_object.number|add:'1' %}" class="btn btn-custom m-1 rounded-circle"><i class="fas fa-share text-primary py-2"></i></a> 
        {% endif %}
        
    </div>  
</div>
{% endif %}       
{% endif %}

{% endblock %}
{% block scripts %}
    {{ block.super }} 

    <script src="{% static 'project/js/measurement.js' %}"></script>         
{% endblock %}